<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Health Data 2017–2025</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="slides_logic.js"></script>
</head>
<body>
<h1>My Health Data 2017–2025</h1>
<h2>An interactive slideshow of my health and fitness data from 2017 through 2025 using data sourced from my Apple Watch and iPhone.</h2>

<div class="pagination">
    <button id="prevSlide">&laquo;</button>
    <button class="page-btn active" data-slide="1">1</button>
    <button class="page-btn" data-slide="2">2</button>
    <button class="page-btn" data-slide="3">3</button>
    <button id="nextSlide">&raquo;</button>
</div>

<div id="loading" class="loading-spinner" style="display:none;">
    Loading heart rate data...
</div>

<div id="slideContainer"></div>

<div class="tooltip" id="tooltip" style="opacity: 0;"></div>

<script>
    const slides = [
        'interactive_slide_part_0.html',
        'interactive_slide_part_1.html',
        'interactive_slide_part_2.html',
    ];

    const slideContainer = document.getElementById("slideContainer");
    const pageButtons = document.querySelectorAll(".page-btn");
    let currentSlide = 0;

    function loadSlide(index) {
        currentSlide = index;
        pageButtons.forEach(btn => btn.classList.remove("active"));
        document.querySelector(`.page-btn[data-slide='${index + 1}']`).classList.add("active");

        if (slides[index]) {
            fetch(slides[index])
                .then(res => res.text())
                .then(html => {
                    const temp = document.createElement("div");
                    temp.innerHTML = html;
                    slideContainer.replaceChildren(...temp.children);
                    window.scrollTo(0, 0);

                    console.log(`Slide ${index} is ${currentSlide}`);
                    setTimeout(() => {
                        switch (index) {
                            case 0:
                                window.initSlide0();
                                break;
                            case 1:
                                window.initSlide1();
                                break;
                            case 2:
                                window.initSlide2();
                                break;
                        }
                    }, 0);

                });
        } else {
            slideContainer.innerHTML = `<div class="coming-soon">Slide ${index + 1} coming soon...</div>`;
            window.scrollTo(0, 0);
        }
    }

    pageButtons.forEach((btn, idx) => {
        btn.addEventListener("click", () => loadSlide(idx));
    });

    document.getElementById("prevSlide").addEventListener("click", () => {
        if (currentSlide > 0) loadSlide(currentSlide - 1);
    });

    document.getElementById("nextSlide").addEventListener("click", () => {
        if (currentSlide < slides.length - 1) loadSlide(currentSlide + 1);
    });

    loadSlide(0);
</script>
</body>
</html>